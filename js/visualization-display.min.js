(function(){jQuery(function(t){var n;return n=function(){function n(n){var i,o,d=this;this.container=n,this.contents=t(".tv-map",this.container),i=t("img",this.container),o=i.width()/i.data("originalWidth"),this.contents.each(function(){return l(this,o)}),this.container.on("click",".tv-map",u),window.onhashchange=function(t){return a(d,t)},a(this)}var i,o,a,d,r,e,c,h,l,u,s;return o=TVAjax.ajaxurl,i="px",n.modal=null,n.modalBg=null,d=function(){return window.location.hash=""},l=function(n,o){var a,d;return a=t(n).data(),d={left:a.x1*o+i,top:a.y1*o+i,height:a.height*o+i,width:a.width*o+i},t(n).css(d)},h=function(t){var n,i,o;return o=window.location.hash,n="technology-"+t,window.location.hash=n,i=RegExp("^#?"+n+"$"),!o.match(i)},r=function(){var t=this;return null!=this.modal?this.modal.fadeOut(function(){return t.modal.add(t.modalBg).hide().empty()}):void 0},c=function(n){var i,o,a;return i=t(document).scrollTop(),a=t(n).offset().top,o=a+t(n).height(),a>i||i>o?t(document).scrollTop(a):void 0},s=function(n,o){var a;if(n)return this.modal||(this.modal=t("<div/>",{id:"tv-modal"}).hide(),this.modalBg=t("<div/>",{id:"tv-modal-bg"}).on("click",d),t("body").append(this.modal).append(this.modalBg)),"function"==typeof o&&o(),a=t(document).scrollTop()+20+i,this.modal.html(n).css("top",a),this.modal.add(this.modalBg).fadeIn()},e=function(n,i){var a;return a={action:"get_visualization_content",contentId:n},t.post(o,a,function(t){return s(t,i)})},a=function(n,i){var o,a,d,h,l;return a=window.location.hash,a&&"#"!==a?(d=a.match(/#technology\-(.*)$/),l=null!=d?d[1]:void 0,l&&(h=t(n.contents).filter("[data-slug="+l+"]"))?(i||(o=c(n.container)),e(h.data("id"),o)):void 0):r()},u=function(n){var i,o;return n.preventDefault(),i=t(this).data("id"),o=t(this).data("slug"),i&&!h(o)?e(i):void 0},n}(),t(".tv-visualization").each(function(){return new n(t(this))})})}).call(this);