jQuery(function(a){var c,e,d,g,h=function(a){d.fadeOut(function(){d.remove();g.remove();a&&a()})},f=function(a){c.fadeOut(function(){c.remove();e.remove();a&&a()})},j=function(c){f(function(){var b=JSON.parse(c);if(b){d||(d=a("<div/>",{id:"tv-mapper"}).hide(),g=a("<div/>",{id:"tv-modal-bg"}).on("click",h),a("body").append(d).append(g));b=a("<img/>",{src:b.src}).data({id:b.id,width:b.width,height:b.height});b=a("<div/>",{"class":"mapper-wrapper"}).append(b);d.append(b);var b=d,e=b.find("img"),f=e.data();
e.Jcrop({boxWidth:b.width(),trueSize:[f.width,f.height],onSelect:function(b){if(window.confirm("Confirm mapping position?")){var c=a("#positioning");c.find(".positioning-coordinate-x1").val(Math.round(b.x));c.find(".positioning-coordinate-y1").val(Math.round(b.y));c.find(".positioning-coordinate-x2").val(Math.round(b.x2));c.find(".positioning-coordinate-y2").val(Math.round(b.y2));b=a(e).data("id");a("#visualization-id").val(b);h()}}});d.fadeIn()}})},k=function(d){d&&(c||(c=a("<div/>",{id:"tv-modal"}).hide(),
e=a("<div/>",{id:"tv-modal-bg"}).on("click",f),a("body").append(c).append(e)),c.html(d),c.on("click",".image",function(){visualizationId=a(this).parents("tr").data("visualizationId");a.post(ajaxurl,{action:"get_visualization_mapper",visualizationId:visualizationId},j)}),c.fadeIn())};a("#positioning, #visualization .visualization").hide();a("#visualization").on("click",".js-visualization-trigger",function(c){c.preventDefault();a.post(ajaxurl,{action:"get_visualizations_list"},k)})});